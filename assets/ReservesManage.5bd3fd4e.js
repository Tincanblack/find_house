import{A as C}from"./AdminBreadcrumb.67b9a502.js";import{m as T,P as Y,D as B}from"./DelConfirmModal.aab645ab.js";import{_ as L,r as h,o,c as a,b as e,F as f,y as v,u as r,d as m,v as y,B as M,z as V,s as g,n as w,a as u,f as x,t as d,A as I,x as S,e as U}from"./index.e276e35f.js";import"./base-component.956d89c2.js";const A={props:{reserve:{type:Object,default(){return{}}},btnLoading:{type:Boolean,default:!1}},data(){return{targetItem:{}}},emits:["emit-update-reserve"],mixins:[T],watch:{reserve(){this.targetItem=this.reserve}}},H={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},F={class:"modal-dialog modal-xl",role:"document"},E={class:"modal-content border-0"},q=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},[e("span",null,"\u9810\u7D04\u8A02\u55AE\u7D30\u7BC0")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),N={class:"modal-body"},O={class:"row"},z={class:"col-md-4"},j={class:"d-flex justify-content-end"},G=["src"],J={class:"col-md-8"},K=e("ul",{class:"nav nav-tabs mb-3",id:"myTab",role:"tablist"},[e("li",{class:"nav-item"},[e("button",{class:"nav-link active",id:"contact-tab","data-bs-toggle":"tab","data-bs-target":"#contact",type:"button",role:"tab","aria-controls":"contact","aria-selected":"true"}," \u8AEE\u8A62\u8CC7\u8A0A ")]),e("li",{class:"nav-item"},[e("button",{class:"nav-link",id:"info-tab","data-bs-toggle":"tab","data-bs-target":"#info",type:"button",role:"tab","aria-controls":"info","aria-selected":"false"}," \u6848\u4EF6\u7D30\u7BC0 ")])],-1),Q={class:"tab-content",id:"myTabContent"},W={key:0,class:"tab-pane fade show active",id:"contact",role:"tabpanel","aria-labelledby":"contact-tab"},X={class:"row gx-3"},Z={class:"mb-3 col-lg-6"},ee=e("label",{for:"",class:"form-label me-3 fw-bold"},"\u8AEE\u8A62\u7DE8\u865F",-1),te={class:"mb-3 col-lg-6"},se=e("label",{for:"",class:"form-label me-3 fw-bold"},"\u8AEE\u8A62\u6642\u9593",-1),oe={class:"row gx-3"},ae={class:"mb-3 col-lg-6"},le=e("label",{for:"",class:"form-label me-3 fw-bold"},"\u806F\u7D61\u72C0\u614B",-1),ne={key:0,class:"text-success"},ie={key:1,class:"text-danger"},re={class:"mb-3 col-lg-6"},de=e("label",{for:"",class:"form-label me-3 fw-bold"},"\u6700\u5F8C\u806F\u7D61\u6642\u9593",-1),ce={key:0},_e={key:1},me={class:"row gx-3"},he={class:"mb-3 col-lg-6"},ue={class:"row align-items-center"},pe=e("div",{class:"col-3"},[e("label",{for:"contactName",class:"form-label mb-0 fw-bold"},"\u59D3\u540D ")],-1),be={class:"col-9"},ge={class:"mb-3 col-lg-6"},fe={class:"row align-items-center"},ve=e("div",{class:"col-3"},[e("label",{for:"contactPhone",class:"form-label fw-bold"},"\u6027\u5225 ")],-1),ke={class:"col-9"},ye={class:"form-check form-check-inline"},we=e("label",{class:"form-check-label",for:"male"},"\u5148\u751F",-1),xe={class:"form-check form-check-inline"},Me=e("label",{class:"form-check-label",for:"female"},"\u5C0F\u59D0",-1),Le={class:"row gx-3"},Ie={class:"mb-3 col-lg-6"},$e=e("label",{for:"contactPhone",class:"form-label fw-bold"},"\u96FB\u8A71 ",-1),Pe={class:"mb-3 col-lg-6"},Re=e("label",{for:"freeTime",class:"form-label fw-bold"},"\u65B9\u4FBF\u9023\u7D61\u7684\u6642\u9593 ",-1),De=U('<option value="0"> \u806F\u7D61\u6642\u9593\uFF1A\u7686\u53EF(9:00-21:00) </option><option value="1"> \u806F\u7D61\u6642\u9593\uFF1A\u4E0A\u5348(9:00-12:00) </option><option value="2"> \u806F\u7D61\u6642\u9593\uFF1A\u4E2D\u5348(12:00-14:00) </option><option value="3"> \u806F\u7D61\u6642\u9593\uFF1A\u4E0B\u5348(14:00-18:00) </option><option value="4"> \u806F\u7D61\u6642\u9593\uFF1A\u665A\u4E0A(18:00-21:00) </option>',5),Ce=[De],Te={class:"row"},Ye={class:"mb-3"},Be=e("label",{for:"freeTime",class:"form-label fw-bold"},"\u5BA2\u6236\u8A3B\u8A18 ",-1),Ve={class:"row gx-3"},Se={class:"mb-3 col-lg-12"},Ue=e("label",{for:"",class:"form-label fw-bold"},"\u6848\u4EF6\u540D\u7A31 ",-1),Ae={class:"row row-cols-lg-3 gx-3"},He={class:"mb-3 col"},Fe=e("label",{for:"category",class:"form-label me-1 fw-bold"},"\u5EFA\u7269\u767B\u8A18 ",-1),Ee=e("span",{class:"form-text"},"(\u576A)",-1),qe={class:"mb-3 col"},Ne=e("label",{for:"price",class:"form-label me-1 fw-bold"},"\u4E3B\u5EFA\u7269 ",-1),Oe=e("span",{class:"form-text"},"(\u576A)",-1),ze={class:"mb-3 col"},je=e("label",{for:"houseAge",class:"form-label me-1 fw-bold"},"\u516C\u8A2D\u6BD4 ",-1),Ge={class:"form-text"},Je={class:"mb-3 col"},Ke=e("label",{for:"houseAge",class:"form-label me-1 fw-bold"},"\u5C4B\u9F61 ",-1),Qe=e("span",{class:"form-text"},"(\u5E74)",-1),We={class:"mb-3 col"},Xe={for:"floor",class:"form-label me-1 fw-bold"},Ze={class:"form-text"},et={class:"mb-3 col"},tt=e("label",{for:"pattern",class:"form-label me-1 fw-bold"},"\u683C\u5C40 ",-1),st={class:"form-text"},ot={class:"mb-3 col"},at=e("label",{for:"category",class:"form-label me-1 fw-bold"},"\u5EFA\u7269\u671D\u5411",-1),lt={class:"form-text"},nt={key:0,class:"mb-3 col"},it=e("label",{for:"parking",class:"form-label me-1 fw-bold"},"\u8ECA\u4F4D ",-1),rt={key:1,class:"mb-3 col"},dt=e("label",{for:"parkingPrice",class:"form-label me-1 fw-bold"},"\u8ECA\u4F4D\u50F9\u683C ",-1),ct=e("span",{class:"form-text"}," (\u842C) ",-1),_t={class:"mb-3 col"},mt=e("label",{for:"managementFee",class:"form-label me-1 fw-bold"},"\u7BA1\u7406\u8CBB ",-1),ht=e("span",{class:"form-text"}," (\u5143/\u6708) ",-1),ut={class:"row"},pt={key:0,class:"mb-3 col-lg-6"},bt=e("label",{for:"",class:"form-label fw-bold"},"\u8CC7\u6599\u7570\u52D5\u6642\u9593",-1),gt={class:"mb-3 col-lg-6"},ft=e("label",{for:"",class:"form-label fw-bold"},"\u8B8A\u66F4\u806F\u7D61\u72C0\u614B",-1),vt={class:"form-check form-switch"},kt={key:0,class:"form-check-label",for:"is_paid"},yt=e("span",{class:"text-success"},"\u5DF2\u806F\u7D61",-1),wt={key:1,class:"form-check-label",for:"is_paid"},xt=e("span",{class:"text-danger"},"\u672A\u806F\u7D61",-1),Mt={class:"modal-footer"},Lt=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," \u53D6\u6D88 ",-1),It={class:"spinner-border spinner-border-sm"};function $t(i,l,p,b,t,_){const k=h("RouterLink");return o(),a("div",H,[e("div",F,[e("div",E,[q,e("div",N,[e("div",O,[e("div",z,[e("div",j,[(o(!0),a(f,null,v(t.targetItem.products,s=>(o(),a("div",{key:s},[e("img",{class:"img-fluid",src:s.product.imageUrl,alt:""},null,8,G)]))),128))])]),e("div",J,[K,e("div",Q,[t.targetItem.user?(o(),a("div",W,[e("div",X,[e("div",Z,[ee,e("span",null,r(t.targetItem.id),1)]),e("div",te,[se,e("span",null,r(i.$moment.moment(t.targetItem.create_at*1e3).format("YYYY-MM-DD HH:mm:ss")),1)])]),e("div",oe,[e("div",ae,[le,t.targetItem.is_paid?(o(),a("span",ne,"\u5DF2\u806F\u7D61")):(o(),a("span",ie,"\u5C1A\u672A\u806F\u7D61"))]),e("div",re,[de,t.targetItem.paid_date&&t.targetItem.is_paid?(o(),a("span",ce,r(i.$moment.moment(t.targetItem.paid_date*1e3).format("YYYY-MM-DD HH:mm:ss")),1)):(o(),a("span",_e,"--"))])]),e("div",me,[e("div",he,[e("div",ue,[pe,e("div",be,[m(e("input",{type:"text",class:"form-control",id:"contactName","onUpdate:modelValue":l[0]||(l[0]=s=>t.targetItem.user.name=s)},null,512),[[y,t.targetItem.user.name]])])])]),e("div",ge,[e("div",fe,[ve,e("div",ke,[e("div",ye,[m(e("input",{type:"radio",class:"form-check-input",id:"male","onUpdate:modelValue":l[1]||(l[1]=s=>t.targetItem.user.gender=s),value:"1",name:"\u6027\u5225",rules:"required"},null,512),[[M,t.targetItem.user.gender]]),we]),e("div",xe,[m(e("input",{type:"radio",class:"form-check-input",id:"female","onUpdate:modelValue":l[2]||(l[2]=s=>t.targetItem.user.gender=s),value:"0",name:"\u6027\u5225",rules:"required"},null,512),[[M,t.targetItem.user.gender]]),Me])])])])]),e("div",Le,[e("div",Ie,[$e,m(e("input",{type:"text",class:"form-control",id:"contactPhone","onUpdate:modelValue":l[3]||(l[3]=s=>t.targetItem.user.tel=s)},null,512),[[y,t.targetItem.user.tel]])]),e("div",Pe,[Re,m(e("select",{class:"form-select",name:"",id:"","onUpdate:modelValue":l[4]||(l[4]=s=>t.targetItem.user.message=s)},Ce,512),[[V,t.targetItem.user.message]])])]),e("div",Te,[e("div",Ye,[Be,m(e("textarea",{class:"form-control",name:"",id:"",cols:"30",rows:"5","onUpdate:modelValue":l[5]||(l[5]=s=>t.targetItem.user.memo=s)},`
											`,512),[[y,t.targetItem.user.memo]])])])])):g("",!0),(o(!0),a(f,null,v(t.targetItem.products,s=>(o(),a("div",{key:s.product.id,class:"tab-pane fade show",id:"info",role:"tabpanel","aria-labelledby":"info-tab"},[e("div",Ve,[e("div",Se,[Ue,e("span",{class:w(["badge tag__element mx-1",{"tag__element--main":s.product.category==="\u83EF\u5EC8","tag__element--sec":s.product.category==="\u516C\u5BD3","tag__element--third":s.product.category==="\u5225\u5885","tag__element--fourth":s.product.category==="\u5927\u6A13"}])},r(s.product.category),3),u(k,{to:`/case/${s.product.id}`,target:"_blank"},{default:x(()=>[d(r(s.product.title),1)]),_:2},1032,["to"])])]),e("div",Ae,[e("div",He,[Fe,e("span",null,[d(r(s.product.squareFeet)+" ",1),Ee])]),e("div",qe,[Ne,e("span",null,[d(r(s.product.mainSquareFeet)+" ",1),Oe])]),e("div",ze,[je,e("span",Ge,r(i.$format.calToPercent(s.product.squareFeet,s.product.mainSquareFeet,"management")),1)]),e("div",Je,[Ke,e("span",null,[d(r(s.product.houseAge)+" ",1),Qe])]),e("div",We,[e("label",Xe,[d("\u6A13/\u6A13 "),e("span",Ze,r(s.product.floor)+" (\u6A13) ",1)])]),e("div",et,[tt,e("span",st,r(i.$format.patternFormat(s.product.pattern)),1)]),e("div",ot,[at,e("span",lt,r(s.product.direction),1)]),s.product.parking!==""?(o(),a("div",nt,[it,e("span",null,r(s.product.parking),1)])):g("",!0),s.product.parkingPrice>0?(o(),a("div",rt,[dt,e("span",null,[d(r(s.product.parkingPrice)+" ",1),ct])])):g("",!0),e("div",_t,[mt,e("span",null,[d(r(s.product.managementFee)+" ",1),ht])])])]))),128))]),e("div",ut,[t.targetItem.user?(o(),a("div",pt,[bt,e("div",null,r(i.$moment.moment(t.targetItem.dataTime).format("YYYY-MM-DD HH:mm:ss")),1)])):g("",!0),e("div",gt,[ft,e("div",vt,[m(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[6]||(l[6]=s=>t.targetItem.is_paid=s),"true-value":!0,"false-value":!1,id:"is_paid"},null,512),[[I,t.targetItem.is_paid,void 0,{lazy:!0}]]),t.targetItem.is_paid?(o(),a("label",wt,[d("\u8B8A\u66F4\u70BA "),xt])):(o(),a("label",kt,[d("\u8B8A\u66F4\u70BA "),yt]))])])])])])]),e("div",Mt,[Lt,e("button",{type:"button",class:"btn btn-primary",onClick:l[7]||(l[7]=s=>i.$emit("emit-update-reserve",t.targetItem))},[d(" \u78BA\u8A8D "),m(e("span",It,null,512),[[S,p.btnLoading]])])])])])],512)}const Pt=L(A,[["render",$t]]),Rt={components:{AdminBreadcrumb:C,Pagination:Y,ReserveEditModal:Pt,DelConfirmModal:B},data(){return{isLoading:!1,submitBtnLoading:!1,isProcessingTarget:"",targetItem:{},reserves:[],pagination:{},currentPage:1}},methods:{getReservesList(i=1){this.isLoading=!0,this.currentPage=i,this.$http.get(`https://vue3-course-api.hexschool.io/v2//api/found_houses_v2/admin/orders/?page=${i}`).then(l=>{this.reserves=l.data.orders,this.pagination=l.data.pagination,this.isLoading=!1}).catch(l=>{this.isLoading=!1,this.$httpMessageState(l.response,"\u932F\u8AA4\u8A0A\u606F")})},openReserveModal(i){this.targetItem={...i},this.$refs.reserveModal.openModal()},updateReserve(i){this.submitBtnLoading=!0,this.isProcessingTarget=i.id;const l=i.is_paid,p=this.$moment.moment().unix(),b={data:{...i}};b.data.user.dataTime=p,l&&(b.data.paid_date=p),this.$http.put(`https://vue3-course-api.hexschool.io/v2//api/found_houses_v2/admin/order/${i.id}`,b).then(t=>{this.submitBtnLoading=!1,this.isProcessingTarget="",this.$httpMessageState(t,"\u66F4\u65B0\u8655\u7406\u72C0\u614B",t.data.message),this.$refs.reserveModal.closeModal(),this.getReservesList(this.currentPage)}).catch(t=>{this.submitBtnLoading=!1,this.isProcessingTarget="",this.$httpMessageState(t.response,"\u932F\u8AA4\u8A0A\u606F")})},openDelModal(i){this.targetItem={...i},this.$refs.delReserveModal.openModal()},deleteReserve(){this.submitBtnLoading=!0,this.isProcessingTarget=this.targetItem.id;const i=`https://vue3-course-api.hexschool.io/v2//api/found_houses_v2/admin/order/${this.targetItem.id}`;this.$http.delete(i).then(l=>{this.submitBtnLoading=!1,this.isProcessingTarget="",this.targetItem={},this.$refs.delReserveModal.closeModal(),this.$httpMessageState(l,"\u522A\u9664\u8AEE\u8A62"),this.getReservesList(this.currentPage)}).catch(l=>{this.submitBtnLoading=!1,this.isProcessingTarget="",this.$httpMessageState(l.response,"\u932F\u8AA4\u8A0A\u606F")})},delAllOrders(){this.isLoading=!0,this.$http.delete("https://vue3-course-api.hexschool.io/v2//api/found_houses_v2/admin/orders/all").then(()=>{this.getReservesList()}).catch(i=>{this.isLoading=!1,this.$httpMessageState(i.response,"\u932F\u8AA4\u8A0A\u606F")})}},mounted(){this.getReservesList()}},Dt={class:"main-content container-fluid px-4 bg-light"},Ct=e("h3",{class:"mt-4 fw-bold"},"\u9810\u7D04\u8868\u55AE\u7BA1\u7406",-1),Tt={class:"text-end my-2"},Yt=e("i",{class:"bi bi-x-lg"},null,-1),Bt={class:"table table-hover table-striped table-bordered mt-4 text-center shadow-sm"},Vt=e("thead",{class:"table-dark"},[e("tr",null,[e("th",{width:"5%"},"\u9806\u5E8F"),e("th",{width:"20%",class:"text-start"},"\u6848\u4EF6\u540D\u7A31"),e("th",{width:"15%"},"\u806F\u7D61\u4EBA"),e("th",{width:"10%"},"\u9023\u7D61\u96FB\u8A71"),e("th",{width:"10%"},"\u65B9\u4FBF\u9023\u7D61\u7684\u6642\u9593"),e("th",{width:"10%"},"\u8AEE\u8A62\u6642\u9593"),e("th",{width:"10%"},"\u806F\u7D61\u6642\u9593"),e("th",{width:"10%"},"\u662F\u5426\u8655\u7406"),e("th",{width:"10%"},"\u64CD\u4F5C")])],-1),St={key:0,class:"fs-6 text-muted"},Ut={key:1,class:"fs-6 text-muted"},At={key:2,class:"fs-6 text-muted"},Ht={key:0},Ft={key:1},Et={key:2},qt={key:3},Nt={key:4},Ot={key:0},zt={key:1},jt={class:"form-check form-switch d-inline-block"},Gt=["onUpdate:modelValue","onChange","disabled"],Jt={key:0,class:"form-check-label text-success",for:"is_paid"},Kt={key:1,class:"form-check-label text-danger",for:"is_paid"},Qt={class:"btn-group"},Wt=["onClick","disabled"],Xt=e("i",{class:"bi bi-pencil-square"},null,-1),Zt=["onClick","disabled"],es=e("i",{class:"bi bi-trash3"},null,-1),ts={key:0};function ss(i,l,p,b,t,_){const k=h("LoadingComponent"),s=h("AdminBreadcrumb"),$=h("RouterLink"),P=h("Pagination"),R=h("ReserveEditModal"),D=h("DelConfirmModal");return o(),a(f,null,[e("div",Dt,[u(k,{isLoading:t.isLoading},null,8,["isLoading"]),Ct,u(s),e("div",Tt,[e("button",{type:"button",class:w(["btn btn-danger shadow-sm",{disabled:t.reserves.length===0}]),onClick:l[0]||(l[0]=(...n)=>_.delAllOrders&&_.delAllOrders(...n))},[Yt,d(" \u522A\u9664\u6240\u6709\u6848\u4EF6 ")],2)]),e("table",Bt,[Vt,e("tbody",null,[(o(!0),a(f,null,v(t.reserves,n=>(o(),a("tr",{key:n.id,style:{"vertical-align":"middle"}},[e("td",null,r(n.num),1),(o(!0),a(f,null,v(n.products,c=>(o(),a("td",{key:`${c}`,class:"text-start"},[e("span",{class:w(["badge tag__element me-1",{"tag__element--main":c.product.category==="\u83EF\u5EC8","tag__element--sec":c.product.category==="\u516C\u5BD3","tag__element--third":c.product.category==="\u5225\u5885","tag__element--fourth":c.product.category==="\u5927\u6A13"}])},r(c.product.category),3),u($,{to:`/case/${c.product.id}`,target:"_blank"},{default:x(()=>[d(r(c.product.title),1)]),_:2},1032,["to"])]))),128)),e("td",null,[d(r(n.user.name)+" ",1),n.user.gender==="1"?(o(),a("span",St,"\u5148\u751F")):n.user.gender==="0"?(o(),a("span",Ut,"\u5C0F\u59D0")):(o(),a("span",At,"\u672A\u586B\u5BEB"))]),e("td",null,r(n.user.tel),1),e("td",null,[n.user.message==="1"?(o(),a("span",Ht,"\u4E0A\u5348 (09-12)")):n.user.message==="2"?(o(),a("span",Ft,"\u4E2D\u5348 (12-14)")):n.user.message==="3"?(o(),a("span",Et,"\u4E0B\u5348 (14-18)")):n.user.message==="4"?(o(),a("span",qt,"\u665A\u4E0A (18-21)")):(o(),a("span",Nt,"\u7686\u53EF (09-21)"))]),e("td",null,[e("span",null,r(i.$moment.moment(n.create_at*1e3).format("YYYY-MM-DD HH:mm")),1)]),e("td",null,[n.is_paid&&n.paid_date?(o(),a("span",Ot,r(i.$moment.moment(n.create_at*1e3).format("YYYY-MM-DD HH:mm")),1)):(o(),a("span",zt,"--"))]),e("td",null,[e("div",jt,[m(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":c=>n.is_paid=c,"true-value":!0,"false-value":!1,id:"is_paid",onChange:c=>_.updateReserve(n),disabled:t.isProcessingTarget===n.id},null,40,Gt),[[I,n.is_paid]]),n.is_paid?(o(),a("label",Jt,"\u5DF2\u8655\u7406 ")):(o(),a("label",Kt,"\u672A\u8655\u7406 "))])]),e("td",null,[e("div",Qt,[e("button",{type:"button",class:"btn btn-primary btn-sm",onClick:c=>_.openReserveModal(n),disabled:t.isProcessingTarget===n.id},[Xt,d(" \u7DE8\u8F2F ")],8,Wt),e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:c=>_.openDelModal(n),disabled:t.isProcessingTarget===n.id},[es,d(" \u522A\u9664 ")],8,Zt)])])]))),128))])]),u(P,{pages:t.pagination,onEmitPages:_.getReservesList},null,8,["pages","onEmitPages"])]),u(R,{reserve:t.targetItem,btnLoading:t.submitBtnLoading,onEmitUpdateReserve:_.updateReserve,ref:"reserveModal"},null,8,["reserve","btnLoading","onEmitUpdateReserve"]),u(D,{item:t.targetItem,btnLoading:t.submitBtnLoading,onDelItem:_.deleteReserve,ref:"delReserveModal"},{"modal-text":x(()=>[d(" \u9810\u7D04\u8AEE\u8A62\uFF1A"),t.targetItem.user?(o(),a("span",ts,r(t.targetItem.user.name),1)):g("",!0)]),_:1},8,["item","btnLoading","onDelItem"])],64)}const is=L(Rt,[["render",ss]]);export{is as default};
